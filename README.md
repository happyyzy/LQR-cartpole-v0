# LQR-cartpole-v0
æœ€è¿‘å­¦ä¹ å¼ºåŒ–å­¦ä¹ åœ¨ç”¨cartpoleç¯å¢ƒï¼Œæƒ³ä»æ§åˆ¶è®ºå‡ºå‘çœ‹ä¸€çœ‹æ•ˆæœå¯¹æ¯”ï¼Œçœ‹åˆ°æ§åˆ¶è®ºä¹Ÿç”¨Riccitaæ–¹ç¨‹ï¼Œæƒ³èµ·äº†ä¸€äº›æœ¬ç§‘å¤©å¤©å­¦çš„ä¸œè¥¿ï¼Œé‚ä»Riccitaæ–¹ç¨‹å‡ºå‘ï¼Œåšä¸ªæ§åˆ¶è®º/å¼ºåŒ–å­¦ä¹ /æ•°å­¦/ç‰©ç†æ‚è®°ã€‚
>Chatgptå¸®å¿™æ•´ç†çš„ï¼Œæ‰€ä»¥æ–‡ç« aiå‘³å¾ˆæµ“ã€‚ã€‚

# Part I â€” Weyl Tube Law ä¸ Riccati æ–¹ç¨‹

## 1ï¸âƒ£ Tube formula

è®¾ $M^n$ æ˜¯åµŒå…¥æ¬§å‡ é‡Œå¾—ç©ºé—´ $\mathbb{R}^{n+k}$ çš„ä¸€ä¸ªå…‰æ»‘å­æµå½¢ã€‚  
**Weyl Tube Law** æè¿°äº†åœ¨ $M$ å‘¨å›´æ„é€ ä¸€å±‚åšåº¦ä¸º $r$ çš„â€œç®¡â€ï¼ˆtubeï¼‰æ—¶ï¼Œå…¶ä½“ç§¯çš„å±•å¼€å…¬å¼ï¼š

$$
\mathrm{Vol}(T_r(M)) = \sum_{j=0}^{\lfloor n/2 \rfloor} c_j(r) \int_M P_j(\mathrm{II})
$$

å…¶ä¸­ï¼š
- $T_r(M)$ è¡¨ç¤ºæµ‹åœ°è·ç¦» $M$ ä¸è¶…è¿‡ $r$ çš„ç‚¹é›†ï¼›
- $\mathrm{II}$ æ˜¯ $M$ çš„ç¬¬äºŒåŸºæœ¬å½¢å¼ï¼›
- $P_j(\mathrm{II})$ ç§°ä¸ºgenerrilaizedå¹³å‡æ›²ç‡ï¼Œ $\mathrm{II}$ çš„ $j$ æ¬¡tensor powerçš„ç¼©å¹¶ï¼Œå…³é”®æ˜¯å…¶åœ¨Mä¸Šçš„ç§¯åˆ†å’ŒèƒŒæ™¯ç©ºé—´æ— å…³ï¼ˆfrom Gauss equationï¼‰ ï¼›
- $c_j(r)$ æ˜¯ä¸åŠå¾„ $r$ æœ‰å…³çš„ç³»æ•°ï¼Œå¯ä»¥ç²¾ç¡®å†™å‡ºã€‚

Weylç”¨æ­¤å®šç†è½»æ˜“è¯æ˜äº†è‘—åçš„Gauss-Bonnet-Chernå…¬å¼ï¼Œåæ¥Chernåˆåœ¨å…¶å¯å‘ä¸‹ç»™å‡ºäº†å†…è•´è¯æ˜ï¼Œä¸€è·¯é€šå‘æŒ‡æ ‡å®šç†ä¹‹åº·åº„å¤§é“ã€‚

---

## 2ï¸âƒ£ ä¾‹ä¸€ï¼šä¸‰ç»´ç©ºé—´ä¸­çš„æ›²çº¿

è®¾ $\gamma(s)$ æ˜¯å¼§é•¿å‚æ•°åŒ–çš„ç©ºé—´æ›²çº¿ï¼Œæ›²ç‡ä¸º $\kappa(s)$ã€‚  
æ›²çº¿çš„â€œ $r$ ç®¡â€å®šä¹‰ä¸ºï¼š

$$
T_r(\gamma) = \{ x \in \mathbb{R}^3 \mid \mathrm{dist}(x, \gamma) \le r \}.
$$

å®ƒæ˜¯æ²¿æ›²çº¿æ‰«å‡ºçš„åŠå¾„ä¸º $r$ çš„åœ†æŸ±ä½“ã€‚  
æ­¤æ—¶ Weyl tube law ç»™å‡ºï¼š

$$
\mathrm{Vol}(T_r(\gamma)) = \pi r^2 L(\gamma),
$$

å…¶ä¸­ $L(\gamma)$ æ˜¯æ›²çº¿é•¿åº¦ã€‚  
ç”±äºæ›²çº¿æ˜¯ä¸€ç»´æµå½¢ï¼Œæ‰€æœ‰æ›²ç‡æ•ˆåº”éƒ½éšè—åœ¨é•¿åº¦é¡¹ä¸­ï¼› $\kappa(s)$ ä½œä¸ºå¤–è•´é‡åœ¨è¿™é‡Œè‡ªç„¶æ¶ˆå¤±ã€‚

---

## 3ï¸âƒ£ ä¾‹äºŒï¼šä¸‰ç»´ç©ºé—´ä¸­çš„é—­æ›²é¢ 

è®¾ $S\subset\mathbb{R}^3$ ä¸ºä¸€ä¸ªå…‰æ»‘ç´§é—­æ›²é¢ã€‚

Weyl çš„ç»“æœåœ¨è¯¥æƒ…å½¢ä¸‹å¯ä»¥å†™ä¸ºï¼ˆ $r$ è¶³å¤Ÿå°ï¼‰ï¼š

$$
\mathrm{Vol}\bigl(T_r(S)\bigr)=2\pi r\mathbb{Area}(S)+ \frac{4\pi}{3} \chi(S) r^3
$$

å…¶ä¸­ $\chi(S)$ ä¸º Euler characteristicï¼Œæ³¨æ„è¿™é‡Œé¢äº¦æ²¡æœ‰ä»»ä½•å¤–è•´æ›²ç‡é¡¹ï¼Œ Euler characteristicå®åˆ™æ¥è‡ªæ›²é¢çš„Gausså®šç†ã€‚

###  Riccati æ–¹ç¨‹å’Œ Tube formulaçš„è¯æ˜

ä¸€èˆ¬è¯æ˜ Weyl ç®¡å…¬å¼æ—¶ï¼Œéœ€è¦ç ”ç©¶æ²¿æ³•çº¿æ—çš„å˜åˆ†å¦‚ä½•ä½¿ä½“ç§¯å…ƒå‘ç”Ÿå˜åŒ–ã€‚æ²¿æ³•å‘çº¿çš„ä¸»æ›²ç‡æ»¡è¶³çŸ©é˜µå½¢å¼çš„ **Riccati æ–¹ç¨‹**ï¼ˆå‡ ä½•ç‰ˆï¼‰ï¼Œå…¶è¿¹æˆ–è¡Œåˆ—å¼çš„å±•å¼€ä¼šç»™å‡ºä½“ç§¯å¤šé¡¹å¼çš„ç³»æ•°ã€‚ä¸ºäº†åœ¨å±€éƒ¨è¿›è¡Œè¿™äº›å±•å¼€ï¼Œå¸¸å¸¸é‡‡ç”¨æ²¿å­æµå½¢æ„é€ çš„ **Fermi åæ ‡**ï¼Œå®ƒæŠŠå­æµå½¢é‚»åŸŸâ€œå±€éƒ¨æ¬§å¼åŒ–â€ï¼Œä»è€ŒæŠŠ Riccati æ–¹ç¨‹çš„è§£å’Œä½“ç§¯å±•å¼€ç›´æ¥è”ç³»èµ·æ¥ã€‚  


---

## 4ï¸âƒ£ é»æ›¼å‡ ä½•ä¸­çš„ Riccati æ–¹ç¨‹

è¦åœ¨ä¸€èˆ¬é»æ›¼æµå½¢ $(\mathcal{M}, g)$ ä¸Šè¯æ˜ Weyl tube lawï¼Œéœ€è¦ç†è§£ä½“ç§¯å…ƒç´ æ²¿**æ³•çº¿æ–¹å‘**å¦‚ä½•å˜åŒ–ã€‚  
è¿™ä¸€å˜åŒ–ç”±æ³•å‘å˜åˆ†çš„ Jacobi æ–¹ç¨‹æ§åˆ¶ã€‚

è®¾ $\gamma\(t\)$ æ˜¯æ³•çº¿æ–¹å‘çš„æµ‹åœ°çº¿ï¼Œ $\dot{\gamma}$ æ˜¯å…¶é€Ÿåº¦ï¼Œ $J(t)$ æ˜¯ä¸€æ—ç›¸é‚»æµ‹åœ°çº¿ä¹‹é—´çš„å˜åˆ†å‘é‡åœºã€‚  
Jacobi æ–¹ç¨‹ä¸ºï¼š

$$
\nabla_{\dot{\gamma}}^2 J + R(J, \dot{\gamma}) \dot{\gamma} = 0,
$$

å…¶ä¸­ $R$ æ˜¯é»æ›¼æ›²ç‡å¼ é‡ã€‚  

å®šä¹‰å½¢ç®—å­ï¼ˆshape operatorï¼‰ï¼š

$$
A(t) = - \nabla_J \mathbf{n},
$$

å…¶ä¸­ $n = \dot{\gamma}/\|\dot{\gamma}\|$ æ˜¯æ³•å‘å•ä½å‘é‡ã€‚  

è®¡ç®—å¯å¾— $A(t)$ æ»¡è¶³ï¼š

$$
A' + A^2 + R = 0 ,
$$


è¿™æ­£æ˜¯ä¸€ä¸ªçŸ©é˜µ **Riccati æ–¹ç¨‹**ã€‚  

- $A$ æè¿°æ³•çº¿æ–¹å‘ä¸Šå­æµå½¢çš„â€œå¼¯æ›²â€ï¼›
- $A'$ è¡¨ç¤ºå¼¯æ›²ç‡çš„å˜åŒ–ï¼›
- $A^2$ è¡¨ç¤ºè‡ªèº«çš„éçº¿æ€§ç§¯ç´¯ï¼›
- $R$ æ˜¯Ricciæ›²ç‡å¼ é‡ã€‚

åœ¨ Weyl tube law çš„è¯æ˜ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ²¿æ³•çº¿æ–¹å‘æ±‚è§£è¯¥æ–¹ç¨‹ï¼Œè¿›è€Œè®¡ç®—ä½“ç§¯å˜åˆ†ï¼š

$$
\det(I - r A)
$$

çš„å±•å¼€æ­£æ˜¯å„ä¸ªæ›²ç‡é¡¹çš„æ¥æºã€‚

æ¢å¥è¯è¯´ï¼Œ**Weyl tube law çš„ç³»æ•°æ˜¯ Riccati æ–¹ç¨‹è§£çš„è¡Œåˆ—å¼å±•å¼€é¡¹**ã€‚

---

## 5ï¸âƒ£ ä» Riccati åˆ° Fermi åæ ‡

è¦åœ¨é»æ›¼æµå½¢ä¸­è¿›è¡Œè¿™ç§å±•å¼€ï¼Œå¿…é¡»é€‰æ‹©ä¸€ç§â€œæ­£äº¤è€Œä¸æ—‹è½¬â€çš„å±€éƒ¨åæ ‡ç³»ï¼Œä½¿å¾—æ³•çº¿æ–¹å‘ä¸åˆ‡ç©ºé—´åˆ†ç¦»ï¼Œä¸”åº¦è§„å±•å¼€ç®€æ´ã€‚  
è¿™ä¾¿å¼•å‡ºäº† **Fermi åæ ‡ï¼ˆFermi coordinatesï¼‰**ã€‚

è®¾ $M$ ä¸Šä¸€ç‚¹ $p$ï¼Œåœ¨å…¶åˆ‡ç©ºé—´å–æ­£äº¤åŸº $\{e_i\}$ï¼Œæ²¿æ³•å‘å•ä½å‘é‡ $n$ å®šä¹‰æ˜ å°„ï¼š

$$
\exp_p(y^i e_i + s n),
$$

å…¶ä¸­ $y^i$ æ˜¯æ²¿ $M$ çš„åˆ‡å‘åæ ‡ï¼Œ$s$ æ˜¯æ³•çº¿åæ ‡ã€‚  

åœ¨ Fermi åæ ‡ä¸‹ï¼Œåº¦è§„å±•å¼€ä¸ºï¼š

$$
g_{ij}(y, s) = \delta_{ij} - \frac{1}{3} R_{ikjl}(p) y^k y^l + O(|y|^3),
$$

è¿™ä½¿å¾—ä½“ç§¯è®¡ç®—å¤§å¹…ç®€åŒ–ã€‚é¡ºä¾¿æä¸€å£å¯¹è¿™ä¸ªå¼å­ç§¯åˆ†èƒ½å¾—åˆ°æµ‹åœ°çƒä½“ç§¯çš„æ¸è¿‘å±•å¼€ï¼Œç¬¬äºŒé¡¹çš„ç§¯åˆ†å¥½åƒè¿˜æ˜¯24å¹´ä¸˜èµ›å‡ ä½•èµ›é“é¢˜æ¥ç€ã€‚

å› æ­¤ï¼š
- Riccati æ–¹ç¨‹åˆ»ç”»äº†æ³•å‘æ›²ç‡çš„æ¼”åŒ–ï¼›
- Fermi åæ ‡æä¾›äº†åº¦è§„å±•å¼€çš„å±€éƒ¨æ¡†æ¶ï¼›
- Weyl tube law çš„è¯æ˜æ­£æ˜¯è¿™ä¸¤è€…çš„ç»“åˆã€‚

è€Œåœ¨å¹¿ä¹‰ç›¸å¯¹è®ºä¸­ï¼Œå…‰çº¿èµ°æ—¶ç©ºæµå½¢çš„æµ‹åœ°çº¿ï¼ŒRiccati æ–¹ç¨‹å°±åˆ»ç”»äº†å…‰çº¿çš„åæŠ˜ï¼Œä¸‹é¢å°±æ¥è°ˆè°ˆå¹¿ç›¸ä¸­çš„å‡ ä½•ä¸Riccatiæ–¹ç¨‹ã€‚

---

# Part II â€” å¹¿ä¹‰ç›¸å¯¹è®ºçš„å‡ ä½•ä¸ Riccati æ–¹ç¨‹

## 1ï¸âƒ£ Shape Operator å’Œ Riccati æ–¹ç¨‹

è€ƒè™‘ä¸€æŸç›¸é‚»æµ‹åœ°çº¿ï¼ˆå…‰çº¿ï¼‰å½¢æˆçš„äºŒç»´æ¨ªæˆªé¢ï¼Œå®šä¹‰ **Shape Operator `B^Î¼_Î½`**ï¼š

$$
B^\mu{}_\nu = \nabla_\nu k^\mu_\perp
$$

å…¶ä¸­ `k^Î¼` æ˜¯å…‰çº¿åˆ‡å‘é‡ï¼Œ`\perp` è¡¨ç¤ºæ¨ªå‘æ­£äº¤æŠ•å½±ã€‚

Riccati å‹æ–¹ç¨‹ä¸ºï¼š

$$
\frac{d B}{d \lambda} + B^2 + R_\perp = 0
$$

-  $B^2 = B^Î¼_Ï B^Ï_Î½$
-  $R_âŠ¥^Î¼_Î½ = R^Î¼_{Î±Î½Î²} k^Î± k^Î²$  

---

## 2ï¸âƒ£ å– trace â†’ Sachs å…‰å­¦æ–¹ç¨‹

å®šä¹‰å…‰æŸè†¨èƒ€ç‡ï¼š

$$
\hat{\theta} = \mathrm{Tr}(B) = B^\mu{}_\mu
$$

å– Riccati æ–¹ç¨‹çš„ traceï¼Œå¾—åˆ° **Sachs å…‰å­¦æ–¹ç¨‹**ï¼ˆå¼±åœºã€çœŸç©º `R_Î¼Î½=0`ï¼‰ï¼š

$$
\frac{d\hat{\theta}}{d\lambda} + \frac{1}{2} \hat{\theta}^2 + |\hat{\sigma}|^2 = 0
$$

åœ¨å¼±åœºè¿‘ä¼¼ä¸‹ï¼Œå‰ªåˆ‡ `|\hat{Ïƒ}|^2` å¯å¿½ç•¥ï¼š

$$
\frac{d\hat{\theta}}{d\lambda} \approx -\frac{1}{2} \hat{\theta}^2
$$

---

## 3ï¸âƒ£ Schwarzschild åº¦è§„ä¸å…‰çº¿è½¨é“

é™æ€çƒå¯¹ç§° Schwarzschild åº¦è§„ï¼š

$$
ds^2 = -\left(1 - \frac{2GM}{r c^2}\right)c^2 dt^2 + \left(1 - \frac{2GM}{r c^2}\right)^{-1} dr^2 + r^2(d\theta^2 + \sin^2\theta\, d\phi^2)
$$

å…‰çº¿åœ¨èµ¤é“å¹³é¢ (`Î¸ = Ï€/2`) ä¸Šï¼Œå®šä¹‰å†²å‡»å‚æ•° `b = L/E`ï¼Œè½¨é“æ–¹ç¨‹ï¼ˆnull geodesicï¼‰ï¼š

$$
\left(\frac{dr}{d\phi}\right)^2 = \frac{r^4}{b^2} - r^2\left(1 - \frac{2GM}{r c^2}\right)
$$

---

## 4ï¸âƒ£ å…‰æŸè†¨èƒ€ç§¯åˆ† â†’ åæŠ˜è§’ï¼ˆå˜é‡ä»£æ¢ `u = 1/r`ï¼‰

### 4.1 è½¨é“æ–¹ç¨‹

å®šä¹‰ `u = 1/r`ï¼Œåˆ™ï¼š

$$
\frac{d^2 u}{d\phi^2} + u = \frac{3GM}{c^2} u^2
$$

è¿™æ˜¯ Schwarzschild å¼±åœºä¸‹å…‰çº¿çš„ Riccati å‹è½¨é“æ–¹ç¨‹ã€‚

### 4.2 å¼±åœºä¸€é˜¶æ‘„åŠ¨è§£

é›¶é˜¶è¿‘ä¼¼ï¼ˆç›´çº¿ï¼‰ï¼š

$$
u_0(\phi) = \frac{\sin\phi}{b}
$$

ä¸€é˜¶ä¿®æ­£ï¼š

$$
\frac{d^2 u_1}{d\phi^2} + u_1 = \frac{3GM}{c^2} u_0^2 = \frac{3GM}{2 c^2 b^2} (1 - \cos 2\phi)
$$

ç§¯åˆ†å¾—åˆ°ï¼š

$$
u_1(\phi) = \frac{GM}{2 c^2 b^2} (3 + \cos 2\phi)
$$

æ€»è½¨é“ï¼š

$$
u(\phi) = u_0(\phi) + u_1(\phi) = \frac{\sin\phi}{b} + \frac{GM}{2 c^2 b^2} (3 + \cos 2\phi)
$$

### 4.3 è®¡ç®—åæŠ˜è§’

è¿œç¦»å¤ªé˜³æ—¶ `r â†’ âˆ â‡’ u â†’ 0`ï¼š

$$
0 = u(\phi_\infty) = \frac{\sin \phi_\infty}{b} + \frac{GM}{2 c^2 b^2} (3 + \cos 2\phi_\infty)
$$

å±•å¼€ `Ï†_âˆ = Ï€/2 + Î´Ï†` å¹¶è¿‘ä¼¼ï¼š

$$
\delta\phi \approx \frac{2GM}{b c^2}
$$

æ€»åæŠ˜è§’ï¼ˆå…¥å°„ + å‡ºå°„ï¼‰ï¼š

$$
\alpha_{\mathrm{GR}} = 2 \delta\phi = \frac{4GM}{b c^2}
$$

---

## 5ï¸âƒ£ æ•°å€¼ä»£å…¥ï¼ˆå¤ªé˜³é™„è¿‘å…‰çº¿ï¼‰

- `GM_â˜‰ = 1.3271244 Ã— 10^{20} m^3/s^2`  
- `R_â˜‰ = 6.957 Ã— 10^8 m`  
- `c = 2.99792458 Ã— 10^8 m/s`

ä»£å…¥å…¬å¼ï¼š

$$
\alpha_{\mathrm{GR}} = \frac{4GM_â˜‰}{R_â˜‰ c^2} \approx 1.751'' \quad (\text{arcseconds})
$$

ç‰›é¡¿ç†è®ºé¢„æµ‹ï¼š

$$
\alpha_{\mathrm{Newton}} = \frac{2GM_â˜‰}{R_â˜‰ c^2} \approx 0.876''
$$

å®éªŒè§‚æµ‹ï¼ˆEddington 1919 æ—¥é£Ÿå®éªŒï¼‰ï¼š

$$
\alpha_{\mathrm{obs}} \approx 1.75''
$$

---

## 6ï¸âƒ£ ç»“è®º

- **Riccati â†’ Sachs æ–¹ç¨‹**ï¼šæè¿°å…‰æŸè†¨èƒ€/å‰ªåˆ‡ç‡æ¼”åŒ–ã€‚  
- **Schwarzschild å¼±åœºç§¯åˆ†**ï¼šå¾—åˆ°ç»å…¸å…‰çº¿åæŠ˜å…¬å¼ `Î± = 4GM/(b c^2)`ã€‚  
- **å¯¹æ¯”ç»“æœ**ï¼š

| ç†è®º | åæŠ˜è§’ | ä¸è§‚æµ‹ |
|------|--------|--------|
| ç‰›é¡¿ | 0.876â€³ | ä½çº¦ 50% |
| GR (Sachs) | 1.751â€³ | å®Œå…¨ç¬¦åˆè§‚æµ‹ |

- **ç‰©ç†æ„ä¹‰**ï¼šå…‰çº¿åæŠ˜çš„ä¸€åŠæ¥æºäºæ—¶é—´è†¨èƒ€æ•ˆåº”ï¼Œä¸€åŠæ¥æºäºç©ºé—´å¼¯æ›²æ•ˆåº”ï¼›Sachs æ–¹ç¨‹æŠŠå…‰æŸçš„æ”¶æ•›/è†¨èƒ€ç‡ä¸åæŠ˜è§’è”ç³»èµ·æ¥ã€‚

æ€»ç»“ä¸€ä¸‹ï¼Œæˆ‘ä»¬é€šè¿‡å¤ªé˜³é™„è¿‘å…‰çº¿åæŠ˜çš„ä¾‹å­ï¼Œå±•ç¤ºäº† **Riccati æ–¹ç¨‹ â†’ Sachs å…‰å­¦æ–¹ç¨‹ â†’ å…‰æŸè†¨èƒ€ç‡ â†’ åæŠ˜è§’** çš„å®Œæ•´æ¨å¯¼ï¼Œå¹¶éªŒè¯äº†å¹¿ä¹‰ç›¸å¯¹è®ºå¯¹ç»å…¸ç‰›é¡¿ç†è®ºçš„å·¨å¤§ä¿®æ­£ã€‚  

Riccati / Sachs æ–¹ç¨‹çš„æ ¸å¿ƒåœ°ä½ä¸ä»…ä½“ç°åœ¨å°å°ºåº¦å¤ªé˜³ç³»å®éªŒä¸Šï¼Œåœ¨ç°ä»£å¤©ä½“ç‰©ç†å’Œå®‡å®™å­¦ä¸­ä¹Ÿå–å¾—äº†æ˜¾è‘—æˆåŠŸï¼š

| åº”ç”¨åœºæ™¯ | ç‰©ç†å¯¹è±¡ | Sachs æ–¹ç¨‹ä½œç”¨ | å®éªŒ/è§‚æµ‹éªŒè¯ |
|----------|----------|----------------|----------------|
| **å¼ºå¼•åŠ›é€é•œ** | æ˜Ÿç³»å›¢ã€è¶…å¤§è´¨é‡é»‘æ´ | å…‰æŸè†¨èƒ€ç‡ \(\hat\theta\) å’Œå‰ªåˆ‡ç‡ \(\hat\sigma\) â†’ æ”¾å¤§ç‡ã€å¤šé‡åƒã€å…‰æŸç„¦æ•£ | Hubble å¤ªç©ºæœ›è¿œé•œè§‚æµ‹çš„çˆ±å› æ–¯å¦ç¯ã€Abell 1689 æ˜Ÿç³»å›¢é€é•œï¼Œæ¨¡å‹ä¸è§‚æµ‹é«˜åº¦ä¸€è‡´ |
| **å®‡å®™å¾®é€é•œ (Microlensing)** | é“¶æ²³ç³»æ’æ˜Ÿæˆ–è¡Œæ˜Ÿ | å…‰æŸæ”¶æ•›ç‡éšæ—¶é—´æ¼”åŒ– â†’ å…‰å˜æ›²çº¿ | OGLE å’Œ MACHO é¡¹ç›®æ¢æµ‹åˆ°çš„æš—å¤©ä½“å€™é€‰ä½“ï¼Œå…‰å˜æ›²çº¿ä¸ç†è®ºåŒ¹é… |
| **CMB å¼±é€é•œ** | å®‡å®™å¤§å°ºåº¦ç»“æ„ | å…‰æŸè†¨èƒ€ä¸å‰ªåˆ‡ â†’ å¼±é€é•œä¿¡å·ã€é‡å»ºå¤§å°ºåº¦è´¨é‡åˆ†å¸ƒ | Planck / ACT / SPT å«æ˜Ÿè§‚æµ‹çš„å¾®é€é•œä¿¡å·ä¸ç†è®ºå»åˆ |
| **é»‘æ´é˜´å½±** | M87*ã€Sgr A* | å…‰æŸè†¨èƒ€/å‰ªåˆ‡ â†’ é˜´å½±è½®å»“å’Œå…‰ç¯äº®åº¦åˆ†å¸ƒ | Event Horizon Telescope (EHT) è§‚æµ‹çš„å…‰ç¯äº®åº¦ä¸ GRMHD + å…‰æŸç§¯åˆ†é¢„æµ‹ä¸€è‡´ |

### æ ¸å¿ƒç»“è®º

- **Riccati æ–¹ç¨‹çš„ç‰©ç†æ„ä¹‰**ï¼šæè¿°å…‰æŸæ¨ªå‘åå·®çŸ©é˜µçš„æ¼”åŒ–ï¼Œç›´æ¥æ§åˆ¶å…‰æŸæ”¶æ•›/è†¨èƒ€å’Œå‰ªåˆ‡ç‡ã€‚  
- **Sachs æ–¹ç¨‹çš„ä½œç”¨**ï¼štrace Riccati æ–¹ç¨‹ï¼Œæä¾›å…‰æŸè†¨èƒ€ç‡ \(\hat\theta\) çš„æ¼”åŒ–è§„å¾‹ï¼Œæ˜¯åˆ†æå¼•åŠ›é€é•œã€å¾®é€é•œã€CMB å¼±é€é•œå’Œé»‘æ´é˜´å½±çš„åŸºç¡€å·¥å…·ã€‚  
- **å®éªŒéªŒè¯**ï¼šä»å¤ªé˜³é™„è¿‘å…‰çº¿åæŠ˜åˆ°æ˜Ÿç³»å›¢å¼ºé€é•œå’Œé»‘æ´é˜´å½±è§‚æµ‹ï¼ŒSachs æ–¹ç¨‹çš„é¢„æµ‹ä¸å®é™…è§‚æµ‹é«˜åº¦ä¸€è‡´ï¼Œè¿œè¶…ç»å…¸ç‰›é¡¿ç†è®ºã€‚

# Part III â€” é‡å­åŠ›å­¦ä¸ Riccati æ–¹ç¨‹

## 1ï¸âƒ£ Riccati æ–¹ç¨‹åœ¨åŠç»å…¸è¿‘ä¼¼ä¸­çš„å‡ºç°

ä»ä¸€ç»´å®šæ€è–›å®šè°”æ–¹ç¨‹ï¼š

$$
-\frac{\hbar^2}{2m}\frac{d^2 \psi(x)}{dx^2} + V(x) \psi(x) = E \psi(x)
$$

å®šä¹‰**é‡å­åŠ¨é‡å‡½æ•°**ï¼š

$$
p(x) := -i \hbar \frac{\psi'(x)}{\psi(x)}
$$

å¾—åˆ° **Riccati æ–¹ç¨‹**ï¼š

$$
p(x)^2 + i \hbar p'(x) = 2m (E - V(x))
$$

- å°†äºŒé˜¶çº¿æ€§å¾®åˆ†æ–¹ç¨‹è½¬ä¸ºä¸€é˜¶éçº¿æ€§æ–¹ç¨‹ã€‚  
- åœ¨åŠç»å…¸è¿‘ä¼¼ $\hbar \ll 1$ ä¸‹å±•å¼€ï¼š

$$
p(x) = p_0(x) + i \hbar p_1(x) + (i\hbar)^2 p_2(x) + \dots
$$

- é›¶é˜¶ $p_0(x) = \sqrt{2m(E - V(x))}$ å¯¹åº”ç»å…¸åŠ¨é‡ï¼Œåç»­é¡¹æä¾›é‡å­ä¿®æ­£ã€‚  
- WKB æ³¢å‡½æ•°ä¸€é˜¶è¿‘ä¼¼ï¼š

$$
\psi(x) \approx \frac{1}{\sqrt{p_0(x)}} \exp\Big(\frac{i}{\hbar} \int^x p_0(x') dx'\Big)
$$

---

### ğŸ”¹ Bohr-Sommerfeld é‡å­åŒ–æ¡ä»¶çš„ç‰©ç†æ„ä¹‰

- å¯¹æŸç¼šæ€ï¼Œæ³¢å‡½æ•°åœ¨ç»å…¸å…è®¸åŒºæ¥å›éœ‡è¡ï¼Œå›åˆ°èµ·ç‚¹æ—¶ç›¸ä½å¿…é¡»å•å€¼ï¼š

$$
\psi(x_{\text{start}}) = \psi(x_{\text{start}} + \text{one period})
$$  

- å¯¹åº” **é—­åˆç§¯åˆ†çš„ç›¸ä½ç´¯ç§¯**ï¼š

$$
\oint p_0(x) dx = 2\pi \hbar \left(n + \frac{1}{2}\right)
$$

- ç‰©ç†è§£é‡Šï¼š**æ³¢å‡½æ•°æ²¿ç»å…¸è½¨é“â€œç»•ä¸€åœˆâ€ç›¸ä½å¿…é¡»æ˜¯ $2\pi$ çš„æ•´æ•°å€**ã€‚  
- Maslov æŒ‡æ•°ä¿®æ­£è½¬æŠ˜ç‚¹ç›¸ä½ï¼Œæ¯ä¸ªç«¯ç‚¹è´¡çŒ® $\pi/2$ï¼Œæ€»å…±åŠ  $\pi \Rightarrow 1/2$ åœ¨é‡å­åŒ–æ¡ä»¶é‡Œã€‚  

---

#### æ³¨ï¼š Maslov æŒ‡æ•°çš„æ•°å­¦ä¸ WKB / Riccati æ–¹ç¨‹

##### Maslov æŒ‡æ•°çš„æ•°å­¦è§è§£

åœ¨åŠç»å…¸é‡å­åŠ›å­¦ä¸­ï¼ŒWKB æ³¢å‡½æ•°å¯å†™ä¸ºï¼š

$$
\psi(\mathbf{q},t) \sim A(\mathbf{q},t) \, e^{\frac{i}{\hbar} S(\mathbf{q},t)},
$$

å…¶ä¸­ $S(\mathbf{q},t)$ æ˜¯ä½œç”¨é‡å‡½æ•°ï¼Œå…¶æ¢¯åº¦ç»™å‡º Riccati æ–¹ç¨‹çš„é›¶é˜¶è§£ï¼š

$$
p_0(\mathbf{q}) = \nabla S(\mathbf{q}).
$$

å°† $p_0(\mathbf{q})$ çš„å‡½æ•°å›¾åƒæ”¾å…¥ç›¸ç©ºé—´ $(\mathbf{q},\mathbf{p})$ ä¸­ï¼š

$$
L(t) = \{ (\mathbf{q}, \mathbf{p}) \mid \mathbf{p} = \nabla S(\mathbf{q},t) \},
$$

å¾—åˆ°ä¸€ä¸ª **Lagrangian æµå½¢**ï¼Œå®ƒæ»¡è¶³è¾›ç»“æ„é€€åŒ–ï¼š

$$
\omega|_{L(t)} = 0, \quad \omega = \sum_{i=1}^{n} dq_i \wedge dp_i.
$$

æ²¿ Hamiltonian æµ $\Phi_H^t$ æ¼”åŒ–ï¼š

$$
L(t) = \Phi_H^t(L(0)),
$$

æµå½¢ä¿æŒ Lagrangian æ€§è´¨ã€‚å¯¹æµå½¢çš„å°æ‰°åŠ¨çº¿æ€§åŒ–ï¼š

$$
\delta \mathbf{z}(t) = M(t) \, \delta \mathbf{z}(0), \quad M(t) \in Sp(2n,\mathbb{R}),
$$

äºæ˜¯ Lagrangian æµå½¢æ¼”åŒ–å¯¹åº” **è¾›ç¾¤ä¸Šçš„ä¸€æ¡æ›²çº¿** $M(t)$ã€‚

ä¸ºäº†å®šä¹‰ Maslov æŒ‡æ•°ï¼Œå¼•å…¥å‚è€ƒ Lagrangian å­ç©ºé—´ $L_0$ï¼ˆä¾‹å¦‚ $\mathbf{p}=0$ï¼‰ï¼Œ**Maslov cycle** $\Sigma$ å®šä¹‰ä¸ºï¼š

$$
\Sigma = \{ L \in \Lambda(n) \mid L \cap L_0 \neq \{0\} \},
$$

å³æ‰€æœ‰ä¸å‚è€ƒå­ç©ºé—´éå¹³å‡¡ç›¸äº¤çš„ Lagrangian å­ç©ºé—´é›†åˆã€‚ç‰©ç†ä¸Šï¼ŒMaslov cycle å¯¹åº”æµå½¢æŠ˜å æˆ– WKB æŒ¯å¹…å‘æ•£çš„ä½ç½®ï¼ˆcausticï¼‰ã€‚æ²¿ Hamiltonian æµæ¼”åŒ–çš„æµå½¢æ¯æ¬¡ç©¿è¿‡ $\Sigma$ï¼š

- WKB æ³¢å‡½æ•°ç›¸ä½å¢åŠ  $\pi/2$
- ç©¿è¿‡æ¬¡æ•°ç´¯åŠ å¾—åˆ° **Maslov æŒ‡æ•°** $\mu$

åœ¨ä¸€ç»´æŸç¼šæ€ä¸­ï¼Œä¸¤ä¸ªè½¬æŠ˜ç‚¹å¯¹åº” $\mu = 2$ï¼Œè¿›å…¥ Bohr-Sommerfeld ä¿®æ­£ï¼š

$$
\oint p \, dq = 2\pi \hbar \left(n + \frac{\mu}{4}\right) = 2\pi \hbar \left(n + \frac12\right)
$$

åœ¨é«˜ç»´ç³»ç»Ÿä¸­ï¼ŒMaslov æŒ‡æ•°ä»ç„¶é€šè¿‡æµå½¢ç©¿è¿‡ $\Sigma$ çš„æ¬¡æ•°å®šä¹‰ï¼Œæ˜¯æ›²çº¿åœ¨ Lagrangian Grassmannian ä¸Šçš„æ‹“æ‰‘é‡ã€‚

---

##### Arnold å¯¹ Maslov æŒ‡æ•°çš„è´¡çŒ®

V. I. Arnold åœ¨ 1960s ç³»ç»Ÿç ”ç©¶äº† Lagrangian æµå½¢çš„å¥‡å¼‚ç»“æ„ï¼Œæå‡ºåˆ©ç”¨ **çªå˜ç†è®ºï¼ˆCatastrophe Theoryï¼‰** åˆ†ç±» WKB ä¸­çš„ causticã€‚æ ¸å¿ƒæ€æƒ³ï¼š

1. æµå½¢æŠ˜å å¯¹åº”å‡½æ•°å¥‡å¼‚ç‚¹ï¼ˆä¸´ç•Œç‚¹ï¼‰ï¼š

   - ä¸€ç»´ï¼šfoldï¼ˆæŠ˜å ï¼‰  
   - äºŒç»´ï¼šcuspï¼ˆä¸‰æ¬¡æŠ˜å ï¼‰  
   - ä¸‰ç»´åŠä»¥ä¸Šï¼šswallowtailã€umbilic ç­‰  

2. å¯¹äºä»»æ„ Lagrangian æµå½¢ $L(t)$ ä¸å‚è€ƒå­ç©ºé—´ $L_0$ çš„äº¤ç‚¹ï¼Œå±€éƒ¨è¡Œä¸ºå¯ç”¨æ ‡å‡†å‹æè¿°ï¼š

$$
S(\mathbf{q}) \sim \sum_{i=1}^{k} \pm q_i^m, \quad m = 2,3,4,\dots
$$

è¿™å¯¹åº” Maslov cycle çš„å±€éƒ¨æ‹“æ‰‘ç»“æ„ã€‚

3. Maslov æŒ‡æ•°çš„å‡ ä½•è§£é‡Šï¼šæµå½¢æ²¿ Hamiltonian æµæ¼”åŒ–ç©¿è¿‡ä¸åŒç±»å‹å¥‡å¼‚ç‚¹ï¼Œæ¯ä¸ªå¥‡å¼‚ç‚¹å¯¹åº” WKB ç›¸ä½è·³ $\pi/2$ï¼Œé€šè¿‡å¥‡å¼‚ç‚¹ç±»å‹å¯ä»¥åˆ¤æ–­ç´¯ç§¯ç›¸ä½ã€‚å½¢å¼åŒ–ä¸Šï¼ŒArnold å°† Maslov æŒ‡æ•°çœ‹ä½œ Lagrangian Grassmannian ä¸­æ›²çº¿ç©¿è¿‡ Maslov cycle çš„ **æ‹“æ‰‘ä¸å˜é‡**ï¼š

$$
\mu = \sum_{\text{ç©¿è¿‡å¥‡å¼‚ç‚¹}} \text{sgn}(\det H_{\text{å±€éƒ¨}}(S))
$$

å…¶ä¸­ $H_{\text{å±€éƒ¨}}(S)$ æ˜¯å±€éƒ¨ Hessianï¼Œç”¨äºåˆ¤æ–­ç©¿è¶Šæ–¹å‘ã€‚  

4. Arnold çš„è´¡çŒ®ä¸ä»…ä½¿ Maslov æŒ‡æ•°ä»ä¸€ç»´æŸç¼šæ€æ¨å¹¿åˆ°é«˜ç»´ç³»ç»Ÿï¼Œè¿˜æä¾›äº† **å±€éƒ¨å¥‡å¼‚ç‚¹åˆ†ç±» + æ‹“æ‰‘è®¡æ•°çš„ç»Ÿä¸€æ•°å­¦æ¡†æ¶**ï¼Œè§£é‡Šäº†åŠç»å…¸é‡å­åŠ›å­¦ä¸­ WKB ç›¸ä½è·³çš„è§„å¾‹æ€§å’Œæ™®é€‚æ€§ã€‚

è¿™äº›åœ¨ä»–çš„MMCMé‡Œé¢æœ‰è¯¦ç»†ä»‹ç»ã€‚

#### å’Œå‡ ä½•é‡å­åŒ–çš„è”ç³»ï¼ˆref GTM256?ï¼‰
Maslov æŒ‡æ•°åœ¨å‡ ä½•é‡å­åŒ–ä¸­æ‰®æ¼”äº†æ ¸å¿ƒè§’è‰²ã€‚åœ¨åŠç»å…¸é‡å­åŒ–ä¸­ï¼ŒWKB æ³¢å‡½æ•°å¯¹åº”ç›¸ç©ºé—´ä¸­çš„ Lagrangian æµå½¢ $L \subset (M, \omega)$ï¼ŒRiccati æ–¹ç¨‹é›¶é˜¶è§£ 

$$
p_0(\mathbf{q}) = \nabla S(\mathbf{q})
$$

çš„å‡½æ•°å›¾åƒæ­£æ˜¯ Lagrangian æµå½¢çš„å±€éƒ¨è¡¨ç¤ºã€‚æµå½¢æ²¿ Hamiltonian æµæ¼”åŒ–æ—¶ï¼Œä¼šç©¿è¿‡ causticï¼ˆMaslov cycleï¼‰ä½ç½®ï¼Œä½¿å¾—åŠç»å…¸æ³¢å‡½æ•°ç›¸ä½è·³ $\pi/2$ã€‚åœ¨å‡ ä½•é‡å­åŒ–æ¡†æ¶ä¸‹ï¼Œç›¸ç©ºé—´è¢«æå‡ä¸ºä¸€ä¸ªprequantum line bundleå¹¶é…å¤‡è”ç»œ $\nabla$ï¼Œå…¶æ›²ç‡æ»¡è¶³

$$
F_\nabla = -i \omega / \hbar.
$$

æ²¿ Lagrangian æµå½¢å¹³è¡Œç§»åŠ¨çš„åŠç»å…¸æ³¢å‡½æ•°ä¸ä»…ç´¯ç§¯ Hamilton-Jacobi ä½œç”¨é‡ $S$ï¼Œè¿˜è¦åŠ ä¸Š Maslov ç›¸ä½ $\mu \pi/2$ï¼Œä»¥ä¿è¯æ³¢å‡½æ•°å…¨å±€ä¸€è‡´ã€‚æ¢å¥è¯è¯´ï¼ŒMaslov cycle å¯¹åº”æåŒ–æ–¹å‘çš„æŠ˜å æˆ– causticï¼Œè€Œ Maslov æŒ‡æ•°å°±æ˜¯å‰é‡å­çº¤ç»´ä¸›ä¸Šæ²¿ Lagrangian å›è·¯çš„æ‹“æ‰‘ç›¸ä½ä¿®æ­£ã€‚åœ¨å‡ ä½•é‡å­åŒ–ä¸­ï¼ŒLagrangian æµå½¢ç­‰ä»·äºæåŒ–ï¼ˆpolarizationï¼‰ï¼ŒMaslov cycle æ˜¯æåŒ–æ–¹å‘çš„å¥‡å¼‚é›†ï¼Œè€Œ Maslov æŒ‡æ•°ç¡®ä¿å‡ ä½•é‡å­åŒ–å¾—åˆ°ä¸€è‡´çš„ Hilbert ç©ºé—´ç»“æ„ã€‚å¦‚æœå¿½ç•¥ Maslov æŒ‡æ•°ï¼Œæ³¢å‡½æ•°åœ¨å…¨å±€å°†ä¸è¿ç»­ï¼Œå› æ­¤å®ƒæ˜¯ WKB ä¿®æ­£ä¸å‡ ä½•é‡å­åŒ–ä¹‹é—´çš„æ¡¥æ¢ã€‚

å¦å¤–prequantum line bundleæ›²ç‡çš„é‡å­åŒ–æ¡ä»¶å…¶å®æ˜¯è¯´ $F_\nabla$ å°±æ˜¯prequantum line bundleçš„chernç±»ï¼Œè¿™ä¹‹ååˆæ˜¯å¦ä¸€æ¡åˆ°æŒ‡æ ‡å®šç†çš„è·¯-Geometric Quatization Approchã€‚



## 2ï¸âƒ£ è°æŒ¯å­ä¾‹å­

è€ƒè™‘ä¸€ç»´é‡å­è°æŒ¯å­ï¼š

$$
V(x) = \frac{1}{2} m \omega^2 x^2
$$

### 2.1 Riccati æ–¹ç¨‹

$$
p(x)^2 + i \hbar p'(x) = 2 m \left(E - \frac{1}{2} m \omega^2 x^2\right)
$$

### 2.2 åŠç»å…¸å±•å¼€

$$
p_0(x) = \sqrt{2 m (E - \frac{1}{2} m \omega^2 x^2)}, \quad 
p_1(x) = -\frac{p_0'(x)}{2 p_0(x)}
$$

WKB æ³¢å‡½æ•°ï¼š

$$
\psi(x) \approx \frac{1}{\sqrt{p_0(x)}} \exp\Big(\frac{i}{\hbar} \int^x p_0(x') dx'\Big)
$$

### 2.3 é—­åˆç§¯åˆ†è®¡ç®—

ç»å…¸å…è®¸åŒº $[-x_{\max}, x_{\max}]$ï¼Œå…¶ä¸­ $x_{\max} = \sqrt{2E/(m\omega^2)}$ï¼š

$$
\oint p_0 dx = 4 \int_0^{x_{\max}} \sqrt{2 m \left(E - \frac{1}{2} m \omega^2 x^2\right)} dx
$$

æ¢å˜é‡ $x = x_{\max} \sin \theta$ï¼š

$$
\oint p_0 dx = \frac{2 \pi E}{\omega}
$$

### 2.4 Bohr-Sommerfeld æ¡ä»¶ + Maslov ä¿®æ­£

$$
\frac{2 \pi E}{\omega} = 2 \pi \hbar \left(n + \frac{1}{2}\right) \quad \Rightarrow \quad
E_n = \hbar \omega \left(n + \frac{1}{2}\right)
$$

- å®Œå…¨åŒ¹é…é‡å­è°æŒ¯å­ç²¾ç¡®èƒ½çº§  
- å±•ç¤ºäº† **Riccati æ–¹ç¨‹ â†’ WKB â†’ Bohr-Sommerfeld æ¡ä»¶ â†’ Maslov ä¿®æ­£** çš„å®Œæ•´æµç¨‹  

---

## 3ï¸âƒ£ æ•°å­¦ç‰©ç†å¯¹ Riccati æ–¹ç¨‹è§£çš„ç ”ç©¶

### 3.1 åŠç»å…¸å±•å¼€ä¸æ¸è¿‘åˆ†æ

- å°† Riccati æ–¹ç¨‹è§£ $p(x)$ å±•å¼€ä¸ºå¹‚çº§æ•°
- ç ”ç©¶æ”¶æ•›æ€§ä¸æ¸è¿‘æ€§è´¨ï¼Œè¿™å—ä¸€ä¸ªå¸¸è§çš„å·¥å…·å°±æ˜¯éœ‡è¡ç§¯åˆ†çš„æ¸è¿‘å±•å¼€ï¼Œéç‚¹æ³•/ç¨³å®šç›¸ä½æ³•é‚£ä¸€å¥—ï¼ŒAireyç§¯åˆ†æ˜¯æœ€ç»å…¸çš„ä¾‹å­ï¼›æ•°è®ºé‡Œé¢ä¹Ÿæœ‰ç”¨ï¼Œæ¯”å¦‚Steinçš„complex analysisé™„å½•å°±æœ‰ä¸€ç« ç‰¹æ„è®²è¿™ä¸ªã€‚
- Maslov æŒ‡æ•°å’Œè½¬æŠ˜ç‚¹åŒ¹é…
- Stokes ç°è±¡ä¸å¤å¹³é¢å»¶æ‹“
- **åº”ç”¨ç¤ºä¾‹**ï¼šé¢„æµ‹æŸç¼šæ€èƒ½çº§ã€è§£é‡Šé‡å­éš§ç©¿æŒ‡æ•°è¡°å‡å› å­

### 3.2 Riemann é¢ä¸å…¨å±€è§£æç»“æ„

- Riccati æ–¹ç¨‹è§£æ˜¯å¤šå€¼å‡½æ•°ï¼Œå®šä¹‰åœ¨ Riemann é¢ä¸Š
- é‡å­æç‚¹èšåˆæˆç»å…¸åˆ†æ”¯
- éå¾®æ‰°æ•ˆåº”ï¼š$\exp(-1/\hbar)$ æˆ– $\log(1/\hbar)$
- **åº”ç”¨ç¤ºä¾‹**ï¼šå¤æ‚åŠ¿ä¸‹é‡å­æ€ç»“æ„ã€éå¾®æ‰°éš§ç©¿


### 3.3 ç ”ç©¶æ–¹å‘

- Riemann-Hilbert Problem/Diffrential Galois theoryï¼šé€šè¿‡è¾¹ç•Œæ¡ä»¶ç¡®å®šå…¨å±€è§£æè§£
- PainlevÃ© æ–¹ç¨‹è”ç³»ï¼šæŸäº›åŠ¿ä¸‹ Riccati è§£æ»¡è¶³éçº¿æ€§ PainlevÃ© æ–¹ç¨‹
- Quantum Spectral Curvï¼‰ï¼šé«˜èƒ½ç‰©ç†ã€å¼¦ç†è®ºé‡å­ç³»ç»Ÿè°±åˆ†æ

---

### ğŸ”¹ æ€»ç»“

- Riccati æ–¹ç¨‹è´¯ç©¿åŠç»å…¸é‡å­åŠ›å­¦çš„ WKB æ–¹æ³•ã€Bohr-Sommerfeld æ¡ä»¶åŠ Maslov æŒ‡æ•°ä¿®æ­£
- åœ¨è°æŒ¯å­ä¾‹å­ä¸­ç›´æ¥å¾—åˆ°ç²¾ç¡®èƒ½çº§
- ç°ä»£æ•°å­¦ç‰©ç†å…³æ³¨è§£çš„å…¨å±€ Riemann é¢ç»“æ„ã€éå¾®æ‰°æ•ˆåº”ã€æ•°å€¼ç²¾ç¡®è®¡ç®—åŠé«˜çº§å‡ ä½•ç»“æ„
- æ˜¯è¿æ¥ç»å…¸åŠ¨åŠ›å­¦ä¸é‡å­ç³»ç»Ÿè§£æç»“æ„çš„é‡è¦æ¡¥æ¢

# Part IIII â€” å‡ ä½•æ§åˆ¶è®ºä¸ Riccati æ–¹ç¨‹

## 1. LQR çš„è¾›å‡ ä½•ç»“æ„

è®¾è¿ç»­æ—¶é—´ LQR ç³»ç»Ÿï¼š

$$
\dot{x} = A x + B u, \quad
J[u] = \int_0^T \big( x^\top Q x + u^\top R u \big) \, dt
$$

å…¶ä¸­ $$Q = Q^\top \ge 0$$, $$R = R^\top > 0$$ã€‚  

é€šè¿‡ Pontryagin æœ€å¤§å€¼åŸç†ï¼Œå¼•å…¥å…±è½­å˜é‡ $$p$$ï¼Œæ„å»º Hamiltonianï¼ˆæ¶ˆå»æœ€ä¼˜ $$u$$ï¼‰ï¼š

$$
u^* = \frac{1}{2} R^{-1} B^\top p
$$

$$
H_c(x,p) = p^\top (A x + B u^*) - \big( x^\top Q x + u^{*\top} R u^* \big)
$$

å°† $$(x,p)$$ ç»„åˆæˆ $$z = \begin{bmatrix} x \\ p \end{bmatrix}$$ï¼Œå¾—åˆ°çº¿æ€§ Hamilton ç³»ç»Ÿï¼š

$$
\dot{z} = H z, \quad
H = 
\begin{bmatrix}
A & -B R^{-1} B^\top \\
-Q & -A^\top
\end{bmatrix} \in \mathfrak{sp}(2n,\mathbb{R})
$$

- $$H$$ æ»¡è¶³

$$
H^\top J + J H = 0, \quad 
J = \begin{bmatrix} 0 & I \\ -I & 0 \end{bmatrix}, \quad 
\Rightarrow e^{t H} \in \mathrm{Sp}(2n, \mathbb{R})
$$

- ç›¸ç©ºé—´ $$(x,p)$$ çš„è¾›å½¢å¼ï¼š

$$
\omega = dx \wedge dp
$$

- Lagrangian å­ç©ºé—´ $$L \subset \mathbb{R}^{2n}$$ å¯ä»¥å†™ä½œï¼š

$$
L = \{ (x, S x) \mid x \in \mathbb{R}^n \}, \quad S = S^\top
$$

- éšæ—¶é—´æ¼”åŒ–ï¼š

$$
L_t = e^{t H} L_0
$$

ä»æ˜¯ Lagrangianï¼Œå¯¹åº”çŸ©é˜µ $$S_t$$ æ»¡è¶³ Riccati æ–¹ç¨‹ï¼š

$$
\dot{S} = -A^\top S - S A + S B R^{-1} B^\top S - Q
$$

---

## 2. LQR çš„æ±‚è§£ â€” Legendre å˜æ¢

å®šä¹‰å€¼å‡½æ•°ï¼š

$$
V(x,t) = \min_{u(\cdot)} \int_t^T \big( x^\top Q x + u^\top R u \big) \, dt', \quad V(x,T) = 0
$$

HJB æ–¹ç¨‹ï¼š

$$
-\partial_t V = \min_u \Big[ (\partial_x V)^\top (A x + B u) + x^\top Q x + u^\top R u \Big]
$$

æœ€ä¼˜ $$u$$ï¼š

$$
0 = B^\top \partial_x V + 2 R u \quad \Rightarrow \quad u^* = -\frac{1}{2} R^{-1} B^\top \partial_x V
$$

å‡è®¾äºŒæ¬¡å‹å€¼å‡½æ•°ï¼š

$$
V(x,t) = \frac{1}{2} x^\top S(t) x \quad \Rightarrow \quad \partial_x V = S x
$$

ä»£å…¥ HJBï¼Œå¾—åˆ°è¿ç»­æ—¶é—´ Riccati æ–¹ç¨‹ï¼š

$$
\dot{S} = -A^\top S - S A + S B R^{-1} B^\top S - Q
$$

æœ€ä¼˜åé¦ˆå¾‹ï¼š

$$
u^* = -R^{-1} B^\top S x
$$

ç¨³æ€è§£ $$S_\infty$$ å¯¹åº”é—­ç¯çŸ©é˜µï¼š

$$
A_\mathrm{cl} = A - B R^{-1} B^\top S_\infty
$$

---

## 3. Riccati æµçš„ç¨³å®šæ€§ä¸å‡ ä½•ç»“æ„

### 3.1 ç¨³å®šæ€§ä¸è°±åˆ¤æ®

Riccati æµï¼š

$$
\dot{S} = -A^\top S - S A + S B R^{-1} B^\top S - Q
$$

å¯¹åº” Hamilton çŸ©é˜µï¼š

$$
H = \begin{bmatrix} A & -B R^{-1} B^\top \\ -Q & -A^\top \end{bmatrix} \in \mathfrak{sp}(2n,\mathbb{R})
$$

- è‹¥ $$H$$ åœ¨å¤å¹³é¢ä¸Šæ²¡æœ‰è™šè½´ç‰¹å¾å€¼ï¼Œåˆ™å­˜åœ¨ç¨³å®šä¸å˜å­ç©ºé—´ $$E^-$$ï¼ŒRiccati æµæœ‰ç¨³å®šæé™è§£ $$S_\infty$$ã€‚  
- é—­ç¯çŸ©é˜µ

$$
A_\mathrm{cl} = A - B R^{-1} B^\top S_\infty
$$

æ˜¯ Hurwitz çš„ï¼Œç³»ç»ŸæŒ‡æ•°ç¨³å®šã€‚

### 3.2 å±€éƒ¨çº¿æ€§åŒ–ä¸æŒ‡æ•°æ”¶æ•›

å¯¹ $$S_\infty$$ åšå°æ‰°åŠ¨ $$\Delta S$$ï¼Œå¾—åˆ°çº¿æ€§åŒ–æ–¹ç¨‹ï¼š

$$
\dot{\Delta S} = -A_\mathrm{cl}^\top \Delta S - \Delta S A_\mathrm{cl}
$$

è°±åœ¨å·¦åŠå¹³é¢ $\Rightarrow$ $$\Delta S(t) \to 0$$ æŒ‡æ•°æ”¶æ•›ã€‚

### 3.3 æ‹‰æ ¼æœ—æ—¥æµä¸ Maslov æŒ‡æ•°

Riccati æµå¯¹åº” Lagrangian å­ç©ºé—´çš„æ—¶é—´æ¼”åŒ–ï¼š

$$
L_t = e^{t H} L_0, \quad L_0 = \{ (x, S_0 x) \mid x \in \mathbb{R}^n \}
$$

- å½“ $$\det X(t_0) = 0$$ï¼ˆç©¿è¿‡ Maslov cycle / å¥‡å¼‚é›†ï¼‰ï¼ŒRiccati è§£ $$S_t$$ ä¼šå‡ºç°â€œçˆ†ç‚¸â€ã€‚  
- Maslov æŒ‡æ•°è®¡æ•° $$L_t$$ ç©¿è¶Šå¥‡å¼‚é›†çš„æ¬¡æ•°åŠæ–¹å‘ï¼Œæä¾›æ‹“æ‰‘ç¨³å®šæ€§ä¿¡æ¯ã€‚  
- Maslov ç©¿è¶Šä¸è°±æµï¼ˆspectral flowï¼‰ç´§å¯†ç›¸å…³ï¼šè°±ç‰¹å¾å€¼ä»å·¦åŠå¹³é¢ç©¿è¿‡è™šè½´ â†” Riccati è§£çš„å¥‡å¼‚äº‹ä»¶ã€‚

### 3.4 æ•°å€¼ä¸å‡ ä½•æ–¹æ³•

- **ç¨³æ€ Riccati è§£æ±‚è§£**ï¼šé€šè¿‡ Hamilton çŸ©é˜µçš„ç¨³å®šä¸å˜å­ç©ºé—´ï¼ˆSchur åˆ†è§£ / ordered Schurï¼‰  
- **Newton-Kleinman è¿­ä»£**ï¼šåˆ©ç”¨çº¿æ€§ Lyapunov æ–¹ç¨‹è¿­ä»£æ”¶æ•›  
- **å‡ ä½•è§£é‡Š**ï¼šç¨³å®šæ€§åˆ†æè½¬åŒ–ä¸ºç ”ç©¶è¾›ç¾¤ä½œç”¨ä¸‹çš„å›ºå®šç‚¹ä¸ Lagrangian æµçš„æ‹“æ‰‘ç»“æ„  
- **å‚æ•°æ•æ„Ÿæ€§**ï¼šé€šè¿‡è¿½è¸ªè°±æµï¼Œé¢„æµ‹ Riccati è§£å¯èƒ½çš„çˆ†ç‚¸ç‚¹æˆ–ç©¿è¶Šäº‹ä»¶

### 3.5 å°ç»“

- Riccati æµçš„ç¨³å®šæ€§å¯ç”± Hamilton çŸ©é˜µè°±åˆ¤å®š  
- Lagrangian Grassmannian ä¸Šçš„å‡ ä½•ç»“æ„ä¸ Maslov æŒ‡æ•°æä¾›å¯¹ç¨³å®šæ€§å’Œå¥‡å¼‚äº‹ä»¶çš„å…¨å±€ç†è§£  
- å‡ ä½•æ–¹æ³•æ¯”å•çº¯ä»£æ•°æ±‚è§£æ›´ç›´è§‚ï¼Œä¹Ÿä¾¿äºåˆ†ææ§åˆ¶ç³»ç»Ÿå‚æ•°å˜åŒ–å¯¹ç¨³å®šæ€§çš„å½±å“

# Part IIIII â€” å¡å°”æ›¼æ»¤æ³¢ä¸ Riccati æ–¹ç¨‹

## ç³»ç»Ÿè®¾å®š

è¿ç»­æ—¶é—´çº¿æ€§é«˜æ–¯ç³»ç»Ÿï¼š

$$
\begin{cases}
\dot{x}(t) = A x(t) + w(t), & w(t) \sim \mathcal{N}(0, Q) \\
y(t) = C x(t) + v(t), & v(t) \sim \mathcal{N}(0, R) \\
x(0) \sim \mathcal{N}(\hat{x}_0, P_0)
\end{cases}
$$

- $x(t) \in \mathbb{R}^n$ï¼šçŠ¶æ€å‘é‡  
- $y(t) \in \mathbb{R}^m$ï¼šè§‚æµ‹å‘é‡  
- $w(t)$ï¼šè¿‡ç¨‹å™ªå£°ï¼Œåæ–¹å·® $Q \succ 0$  
- $v(t)$ï¼šè§‚æµ‹å™ªå£°ï¼Œåæ–¹å·® $R \succ 0$  
- $\hat{x}_0$, $P_0$ï¼šåˆå§‹ä¼°è®¡åŠåæ–¹å·®  

ç›®æ ‡ï¼šæ±‚æœ€ä¼˜ä¼°è®¡ $\hat{x}(t)$ æœ€å°åŒ–è¯¯å·®åæ–¹å·®ï¼š

$$
J = \mathbb{E}[(x(t)-\hat{x}(t))^T (x(t)-\hat{x}(t))]
$$

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šå¡å°”æ›¼æ»¤æ³¢å™¨å¢ç›Š $K(t)$ çš„æ¨å¯¼

### 1.1 å‡è®¾æ»¤æ³¢å™¨å½¢å¼

å‡è®¾æ»¤æ³¢å™¨é‡‡ç”¨å¢ç›Šå½¢å¼ï¼š

$$
d\hat{x} = A \hat{x} \, dt + K(t) \big(dy - C \hat{x} dt\big)
$$

- $K(t) \in \mathbb{R}^{n\times m}$ ä¸ºå¾…å®šå¢ç›ŠçŸ©é˜µ  
- $dy - C \hat{x} dt$ ä¸ºè§‚æµ‹æ®‹å·®  

### 1.2 è¯¯å·®åŠ¨åŠ›å­¦

å®šä¹‰è¯¯å·®ï¼š

$$
e(t) := x(t) - \hat{x}(t)
$$

åˆ©ç”¨ç³»ç»Ÿæ¨¡å‹ï¼š

$$
dx = A x dt + w dt, \quad d\hat{x} = A \hat{x} dt + K(dy - C \hat{x} dt)
$$

è¯¯å·®æ¼”åŒ–ï¼š

$$
de = dx - d\hat{x} = (A - K C)e \, dt + w dt - K v dt
$$

**ç¬¦å·è¯´æ˜**ï¼š

- $e(t)$ æ˜¯ä¼°è®¡è¯¯å·®  
- $A - K C$ æ˜¯è¯¯å·®ä¼ æ’­çŸ©é˜µ  
- $w, v$ ä¸ºè¿‡ç¨‹å™ªå£°å’Œè§‚æµ‹å™ªå£°  

### 1.3 åæ–¹å·®æ¼”åŒ–

å®šä¹‰è¯¯å·®åæ–¹å·®ï¼š

$$
P(t) := \mathbb{E}[ e e^T ] \in \mathrm{Sym}^+(n)
$$

å¯¹ $P(t)$ æ±‚å¯¼ï¼š

$$
\begin{aligned}
\dot{P} &= \frac{d}{dt} \mathbb{E}[e e^T] \\
&= \mathbb{E}[ (de) e^T + e (de)^T + (de)(de)^T ] \\
&= (A-KC) P + P (A-KC)^T + Q + K R K^T
\end{aligned}
$$

- æœ€åä¸€é¡¹ $K R K^T$ æ¥æºäº $\mathbb{E}[( - K v)(-K v)^T] = K R K^T$  

### 1.4 æœ€ä¼˜å¢ç›Š

æœ€å°åŒ– $\mathrm{tr}(P)$ï¼š

$$
\frac{\partial \dot{P}}{\partial K} = 0 \quad \Rightarrow \quad K = P C^T R^{-1}
$$

ä»£å…¥å¯å¾—è¿ç»­æ—¶é—´ Riccati æ–¹ç¨‹ï¼š

$$
\dot{P} = A P + P A^T + Q - P C^T R^{-1} C P
$$

**å‡ ä½•è§£é‡Š**ï¼š

- $P(t)$ æ˜¯åŠæ­£å®šçŸ©é˜µï¼Œè¡¨ç¤ºè¯¯å·®æ¤­çƒ  
- Riccati æµæè¿°æ¤­çƒåœ¨ $\mathrm{Sym}^+(n)$ æµå½¢ä¸Šçš„æ¼”åŒ–  

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šRiccati æ–¹ç¨‹çš„ä¸¥æ ¼æ¨å¯¼ä¸å‡ ä½•æ„ä¹‰

ä»å¢ç›Šå…¬å¼ï¼š

$$
K = P C^T R^{-1}
$$

ä»£å…¥è¯¯å·®åæ–¹å·®æ¼”åŒ–ï¼š

$$
\dot{P} = (A - P C^T R^{-1} C) P + P (A - P C^T R^{-1} C)^T + Q + P C^T R^{-1} R R^{-1} C P
$$

æ•´ç†ï¼š

$$
\dot{P} = A P + P A^T + Q - P C^T R^{-1} C P
$$

### 2.1 å‡ ä½•è§£é‡Š

- æµå½¢ï¼š$\mathrm{Sym}^+(n)$ï¼ŒåŠæ­£å®šçŸ©é˜µæµå½¢  
- Riccati æµ = æµå½¢ä¸Šä¼´éšæµ  
- å„é¡¹å«ä¹‰ï¼š
  - $A P + P A^T$ï¼šæ¤­çƒæ—‹è½¬ã€æ‹‰ä¼¸  
  - $Q$ï¼šè¿‡ç¨‹å™ªå£°è†¨èƒ€  
  - $- P C^T R^{-1} C P$ï¼šè§‚æµ‹ä¿¡æ¯æ”¶ç¼©  

### 2.2 ä¸ LQR å¯¹å¶æ€§

- LQR æœ€ä¼˜åé¦ˆå¾‹ï¼š

$$
u = - R^{-1} B^T S x
$$

- $S(t)$ æ»¡è¶³åŒç±» Riccati æµï¼ˆå¯¹å¶ç»“æ„ï¼‰  
- Riccati æ–¹ç¨‹åœ¨æµå½¢ä¸Šæ§åˆ¶è¯¯å·®æ¤­çƒæˆ–èƒ½é‡æ¤­çƒæ¼”åŒ–  

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šçŠ¶æ€æ›´æ–°å…¬å¼ä¸è¯¯å·®æ¤­çƒ

### 3.1 çŠ¶æ€æ›´æ–°

$$
\hat{x}(t + dt) = \hat{x}(t) + A \hat{x} dt + P C^T R^{-1} (dy - C \hat{x} dt)
$$

### 3.2 è¯¯å·®æ¤­çƒ

å®šä¹‰ï¼š

$$
\mathcal{E}(t) = \{ e \in \mathbb{R}^n : e^T P^{-1} e \le 1 \}
$$

- Riccati æµ = æ¤­çƒæ¼”åŒ–  
- è¯¯å·®æ²¿æ¤­çƒä¸»è½´ä¿®æ­£ â†’ æœ€å¤§åŒ–è§‚æµ‹ä¿¡æ¯åˆ©ç”¨  

---

## ç¬¬å››éƒ¨åˆ†ï¼šä¿¡æ¯å‡ ä½•è§†è§’

### 4.1 Fisher ä¿¡æ¯çŸ©é˜µ

å¯¹äºé«˜æ–¯åˆ†å¸ƒ $\mathcal{N}(\hat{x}, P)$ï¼š

$$
\mathcal{I}(\hat{x}) = P^{-1}
$$

- Riccati æµåœ¨ä¿¡æ¯å‡ ä½•ä¸­ = ä¿¡æ¯æ¤­çƒåœ¨ $\mathrm{Sym}^+(n)$ ä¸Šçš„æ¼”åŒ–  

### 4.2 æµå½¢ä¸åº¦é‡

- æµå½¢ï¼š$\mathrm{Sym}^+(n)$ï¼Œå¸¦ä»¿å°„ä¸å˜é‡åº¦é‡  
- Riccati æµå‘é‡åœºï¼š

$$
\dot{P} = A P + P A^T + Q - P C^T R^{-1} C P
$$

### 4.3 å¯¹å¶æ€§

- ä¸ LQR æ§åˆ¶å¾‹å¯¹å¶  
- Riccati æµ = åŠæ­£å®šçŸ©é˜µæµå½¢ä¸Šçš„è¾›å‡ ä½•ä¼´éšæµ  
- è§‚æµ‹æ›´æ–° = ä¿¡æ¯æŠ•å½±åˆ°å¯è§‚æµ‹å­æµå½¢  

### 4.4 æ€»ç»“

- Riccati æµ = ä¿¡æ¯æ¤­çƒåœ¨ $\mathrm{Sym}^+(n)$ ä¸Šçš„åŠ¨åŠ›å­¦  
- çŠ¶æ€æ²¿ä¿¡æ¯ä¸»è½´ä¿®æ­£ â†’ æœ€ä¼˜èåˆè§‚æµ‹  
- LQR æ§åˆ¶å¾‹ä¸å¡å°”æ›¼æ»¤æ³¢å¢ç›Šç»Ÿä¸€åœ¨åŒä¸€è¾›å‡ ä½•æ¡†æ¶ä¸‹



